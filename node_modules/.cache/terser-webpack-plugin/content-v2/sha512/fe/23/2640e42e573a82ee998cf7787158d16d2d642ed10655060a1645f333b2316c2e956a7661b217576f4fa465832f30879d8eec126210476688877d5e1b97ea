{"code":"!function(e){var t={};function o(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,o),i.l=!0,i.exports}o.m=e,o.c=t,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&\"object\"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,\"default\",{enumerable:!0,value:e}),2&t&&\"string\"!=typeof e)for(var i in e)o.d(n,i,function(t){return e[t]}.bind(null,i));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,\"a\",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p=\"\",o(o.s=36)}([function(e,t){e.exports=function(e){return function(t){var o={code:\"\",type:[\"nat\"]};if(1!=t.length)throw\"Not enough arguments for function\";var n=e.compile.code(t.shift());if(\"int\"!=n.type[0])throw\"Stack error\";return o.code+=n.code,o.code+=e.compile.ml(\"abs\"),o}}},function(e,t){var o={int:{int:\"int\",nat:\"int\",timestamp:\"timestamp\"},nat:{int:\"int\",nat:\"nat\"},mutez:{mutez:\"mutez\"},timestamp:{int:\"timestamp\"}};e.exports=function(e){return function(t){var n={code:\"\",type:!1};if(t.length<2)throw\"Not enough arguments for function\";var i,r=e.compile.ml(\"add\"),c=e.compile.code(t.shift());if(void 0===o[c.type[0]])throw\"Invalid type\";for(n.type=c.type,n.code+=c.code;t.length;){if(i=e.compile.code(t.shift()),void 0===o[n.type[0]][i.type[0]])throw\"Invalid type\";n.type=[o[n.type[0]][i.type[0]]],n.code+=e.compile.ml(\"dip\",i.code),n.code+=r}return n}}},function(e,t){e.exports=function(e){return function(t){var o={code:\"\",type:!1},n=e.compile.condition(t.shift());return o.code+=n,o.code+=\"IF{}{\",t.length?o.code+=e.compile.code(t.shift()).code:o.code+='PUSH string \"Failed assert\";',o.code+=\"FAILWITH};\",o}}},function(e,t){e.exports=function(e){return function(t){var o={code:\"\",type:!1};if(t.length<2)throw\"Not enough arguments for function\";var n,i=e.compile.ml(\"concat\"),r=e.compile.code(t.shift());if([\"string\",\"bytes\"].indexOf(r.type[0])<0)throw\"Invalid type\";for(o.code+=r.code,o.type=r.type;t.length;){if((n=e.compile.code(t.shift())).type[0]!=o.type[0])throw\"Invalid type\";o.code+=e.compile.ml(\"dip\",n.code),o.code+=i}return o}}},function(e,t){e.exports=function(e){return function(t){var o,n={code:\"\",type:[\"string\"]},i=e.compile.code(t.shift()),r=e.compile.code(t.shift());if(\"string\"!=i.type[0])throw\"Invalid type for seperator\";if(\"string\"!=r.type[0])throw\"Invalid type for concat\";for(n.code+=r.code;t.length;){if(n.code+=e.compile.ml(\"dip\",i.code),n.code+=\"CONCAT;\",\"string\"!=(o=e.compile.code(t.shift())).type[0])throw\"Invalid type for concat\";n.code+=e.compile.ml(\"dip\",o.code),n.code+=\"CONCAT;\"}return n}}},function(e,t){e.exports=function(e){return function(t){var o={code:\"\",type:!1};if(t.length){if(\"key_hash\"!=e.compile.code(t.shift()).type[0])throw\"Bad type\";o.code+=deelgate.code,o.code+=\"SOME;\"}else o.code+=\"NONE key_hash;\";return o.code+=\"SET_DELEGATE;\",o.code+=e.compile.ml.storeOperation(),o}}},function(e,t){var o={int:{int:\"int\",nat:\"int\"},nat:{int:\"int\",nat:\"nat\"},mutez:{nat:\"mutez\",mutez:\"nat\"}};e.exports=function(e){return function(t){var n={code:\"\",type:!1};if(t.length<2)throw\"Not enough arguments\";var i,r=e.compile.code(t.shift());if(void 0===o[r.type[0]])throw\"Invalid type\";for(n.type=r.type,n.code+=r.code;t.length;){if(i=e.compile.code(t.shift()[0]),void 0===o[n.type[0]][i.type[0]])throw\"Invalid type\";n.type=[o[n.type[0]][i.type[0]]],n.code+=e.compile.ml(\"dip\",i.code),n.code+='EDIV;IF_SOME{}{PUSH string \"Divisible by 0\";FAILWITH};CAR;'}return n}}},function(e,t){e.exports=function(e){return function(t){var o={code:\"\",type:!1},n=t.shift(),i=e.compile.code(t.shift()),r=e.compile.code(n);if([\"map\",\"big_map\",\"set\"].indexOf(r.type[0]))throw\"Invalid type\";if(e.compile.type(i.type[0])!=e.compile.type(r.type[1]))throw\"Invalid type\";return o.code+=i.code,\"set\"==r.type[0]?o.code+=e.compile.ml(\"dip\",\"PUSH bool False;\"):o.code+=e.compile.ml(\"dip\",\"NONE \"+e.compile.type(r.type[2])+\";\"),o.code+=e.compile.ml(\"diip\",r.code),o.code+=\"UPDATE;\",o.code+=e.compile.setter(n[0]).code,o}}},function(e,t){e.exports=function(e){return function(t){var o={code:\"\",type:!1},n=e.compile.code(t.shift()),i=e.compile.code(t.shift());if([\"map\",\"big_map\"].indexOf(n.type[0]))throw\"Invalid type\";return o.code+=i.code,o.code+=e.compile.ml(\"dip\",n.code),o.code+='GET;IF_SOME{}{PUSH string \"Key not found in map\";FAILWITH};',o.type=n.type[2],o}}},function(e,t){e.exports=function(e){return function(t){var o,n,i={code:\"\",type:[\"bytes\"]};if(t.length<2)throw\"Invalid arguments for function\";if(o=1==t.length?\"blake2b\":t.shift()[0],[\"blake2b\",\"sha256\",\"sha512\"].indexOf(o)<0)throw\"Unknown hash algo\";return n=e.compile.code(t.shift()),i.code+=n.code,i.code+=e.compile.ml(o),i}}},function(e,t){e.exports=function(e){return function(t){var o,n={code:\"\",type:!1},i=e.compile.condition(t.shift()),r=e.compile.code(t.shift()),c=\"\";for(n.code+=i,n.code+=\"IF{\"+r.code+\"}{\",c+=\"}\";t.length;)\"if\"==(o=t.shift())?(i=e.compile.condition(t.shift()),r=e.compile.code(t.shift()),n.code+=i,n.code+=\"IF{\"+r.code+\"}{\",c+=\"}\"):n.code+=e.compile.code(o);return n.code+=c,n.code+=\";\",n}}},function(e,t){e.exports=function(e){return function(t){var o={code:\"\",type:[\"bool\"]},n=e.compile.code(t.shift()),i=e.compile.code(t.shift());if([\"map\",\"big_map\",\"set\"].indexOf(n.type[0]))throw\"Invalid type\";if(e.compile.type(i.type[0])!=e.compile.type(n.type[1]))throw\"Invalid key type\";return o.code+=i.code,o.code+=e.compile.ml(\"dip\",n.code),o.code+=e.compile.ml(\"mem\"),o}}},function(e,t){e.exports=function(e){return function(t){var o={code:\"\",type:[\"bool\"]},n=e.compile.code(t.shift());if(\"option\"!=n.type[0])throw\"Invalid type\";return o.code+=n.code,o.code+=\"IF_SOME{DROP;PUSH bool True}{PUSH bool False};\",o}}},function(e,t){e.exports=function(e){return function(t){var o={code:\"\",type:[\"nat\"]},n=e.compile.code(t.shift());if([\"big_map\",\"map\",\"list\",\"set\",\"string\",\"bytes\"].indexOf(n.type[0])<0)throw\"Invalid type\";return o.code+=n.code,o.code+=\"SIZE;\",o}}},function(e,t){var o={int:{int:\"nat\",nat:\"nat\"},nat:{int:\"nat\",nat:\"nat\"},mutez:{nat:\"mutez\",mutez:\"mutez\"}};e.exports=function(e){return function(t){var n={code:\"\",type:!1};if(t.length<2)throw\"Not enough arguments\";var i,r=e.compile.code(t.shift());if(void 0===o[r.type[0]])throw\"Invalid type\";for(n.type=r.type,n.code+=r.code;t.length;){if(i=e.compile.code(t.shift()[0]),void 0===o[n.type[0]][i.type[0]])throw\"Invalid type\";n.type=[o[n.type[0]][i.type[0]]],n.code+=e.compile.ml(\"dip\",i.code),n.code+='EDIV;IF_SOME{}{PUSH string \"Divisible by 0\";FAILWITH};CDR;'}return n}}},function(e,t){var o={int:{int:\"int\",nat:\"int\"},nat:{int:\"int\",nat:\"nat\"},mutez:{nat:\"mutez\",mutez:\"mutez\"}};e.exports=function(e){return function(t){var n={code:\"\",type:!1};if(t.length<2)throw\"Not enough arguments for function\";var i,r=e.compile.ml(\"mul\"),c=e.compile.code(t.shift());if(void 0===o[c.type[0]])throw\"Invalid type\";for(n.type=c.type,n.code+=c.code;t.length;){if(i=e.compile.code(t.shift()),void 0===o[n.type[0]][i.type[0]])throw\"Invalid type\";n.type=[o[n.type[0]][i.type[0]]],n.code+=e.compile.ml(\"dip\",i.code),n.code+=r}return n}}},function(e,t){e.exports=function(e){return function(t){var o={code:\"\",type:[\"int\"]};if(1!=t.length)throw\"Not enough arguments for function\";var n=e.compile.code(t.shift());if([\"nat\",\"int\"].indexOf(n.type[0])<0)throw\"Invalid type\";return o.code+=n.code,o.code+=e.compile.ml(\"neg\"),o}}},function(e,t){e.exports=function(e){return function(t){var o,n,i={code:\"\",type:!1},r=t.shift();switch(r){case\"set\":o=t.shift(),i.code+=\"EMPTY_SET \"+e.compile.type(o)+\";\",i.type=[\"set\",o];break;case\"list\":o=t.shift(),i.code+=\"NIL \"+e.compile.type(o)+\";\",i.type=[\"list\",o];break;case\"map\":o=t.shift(),n=t.shift(),i.code+=\"EMPTY_MAP \"+e.compile.type(o)+\" \"+e.compile.type(n)+\";\",i.type=[\"map\",o,n];break;default:if(e.helper.findInObjArray(e.map.struct,\"name\",r)<0)throw\"Unknown struct\";t=t.reverse();var c,p=e.compile.code(t.shift());for(i.code+=p.code;t.length;)c=e.compile.code(t.shift()),i.code+=e.compile.ml(\"dip\",c.code),i.code+=\"SWAP;PAIR;\";i.type=[r]}return i}}},function(e,t){e.exports=function(e){return function(t){var o={code:\"\",type:[\"bytes\"]};if(1!=t.length)throw\"Not enough arguments for function\";var n=e.compile.code(t.shift());if(!n.type)throw\"Stack error\";return o.code+=n.code,o.code+=e.compile.ml(\"pack\"),o}}},function(e,t){e.exports=function(e){return function(t){var o={code:\"\",type:!1},n=t.shift(),i=e.compile.code(n);if([\"list\"].indexOf(i.type[0]))throw\"Invalid type\";return o.type=i.type[1],o.code+=i.code,o.code+='IF_CONS{}{PUSH string \"Fail pop\";FAILWITH};',o.code+=e.compile.ml(\"dip\",e.compile.setter(n[0]).code),o}}},function(e,t){e.exports=function(e){return function(t){var o={code:\"\",type:!1},n=t.shift();if(2==t.length){var i=e.compile.code(n),r=e.compile.code(t.shift()),c=e.compile.code(t.shift());if([\"map\",\"big_map\"].indexOf(i.type[0]))throw\"Invalid type\";if(e.compile.type(r.type)!=e.compile.type(i.type[1]))throw\"Invalid type\";if(e.compile.type(c.type)!=e.compile.type(i.type[2]))throw\"Invalid type\";o.code+=r.code,o.code+=e.compile.ml(\"dip\",c.code+e.compile.ml(\"some\")),o.code+=e.compile.ml(\"diip\",i.code),o.code+=e.compile.ml(\"update\")}else if(1==t.length){var p=e.compile.code(n);if(c=e.compile.code(t.shift()),e.compile.type(c.type[0])!=e.compile.type(p.type[1]))throw\"Invalid type\";if(\"list\"==p.type[0])o.code+=c.code,o.code+=e.compile.ml(\"dip\",p.code),o.code+=e.compile.ml(\"cons\");else{if(\"set\"!=p.type[0])throw\"Invalid type\";o.code+=c.code,o.code+=e.compile.ml(\"dip\",\"PUSH bool True;\"),o.code+=e.compile.ml(\"diip\",p.code),o.code+=e.compile.ml(\"update\")}}return o.code+=e.compile.setter(n[0]).code,o}}},function(e,t){e.exports=function(e){return function(t){var o={code:\"\",type:!1};if(t.length<2)throw\"Not enough arguments for function\";var n=e.compile.setter(t.shift()).code,i=e.compile.code(t.shift());return o.code+=i.code,o.code+=n,o}}},function(e,t){e.exports=function(e){return function(t){var o={code:\"\",type:\"\"};if(3!=t.length)throw\"Invalid arguments for function\";var n=e.compile.code(t.shift()),i=e.compile.code(t.shift()),r=e.compile.code(t.shift());if([\"bytes\",\"string\"].indexOf(n.type)<0)throw\"Invalid type, expecting bytes or string\";if(\"nat\"!=i.type)throw\"Invalid type, expecting nat\";if(\"nat\"!=r.type)throw\"Invalid type, expecting nat\";return o.code+=i.code,o.code+=e.compile.ml(\"dip\",r.code),o.code+=e.compile.ml(\"diip\",n.code),o.code+=e.compile.ml(\"slice\"),o.code+=e.complie.error(\"Unable to slice\"),o.type=n.type,o}}},function(e,t){e.exports=function(e){return function(t){var o={code:\"\",type:!1};if(1!=t.length)throw\"Not enough arguments\";var n=e.compile.code(t.shift());if([\"nat\",\"int\",\"mutez\"].indexOf(at.type[0])<0)throw\"Invalid type\";return o.code+=n.code,o.code+=\"DUP;MUL;\",o.type=n.type,o}}},function(e,t){var o={int:{int:\"int\",nat:\"int\",timestamp:\"timestamp\"},nat:{int:\"int\",nat:\"int\"},mutez:{mutez:\"mutez\"},timestamp:{int:\"timestamp\"}};e.exports=function(e){return function(t){var n={code:\"\",type:!1};if(t.length<2)throw\"Not enough arguments for function\";var i,r=e.compile.ml(\"sub\"),c=e.compile.code(t.shift());if(void 0===o[c.type[0]])throw\"Invalid type\";for(n.type=c.type,n.code+=c.code;t.length;){if(i=e.compile.code(t.shift()),void 0===o[n.type[0]][i.type[0]])throw\"Invalid type\";n.type=[o[n.type[0]][i.type[0]]],n.code+=e.compile.ml(\"dip\",i.code),n.code+=r}return n}}},function(e,t){e.exports=function(e){return function(t){var o={code:\"\",type:!1};return t.length?o.code+=e.compile.code(t.shift()).code:o.code+=\"UNIT;\",o.code+=\"FAILWITH;\",o}}},function(e,t){e.exports=function(e){return function(t){var o={code:\"\",type:[\"address\"]};if(1!=t.length)throw\"Invalid arguments for function\";var n=e.compile.code(t.shift());if([\"contract\",\"key_hash\"].indexOf(n.type[0])<0)throw\"Invalid argument type\";return o.code+=n.code,\"key_hash\"!=n.type[0]&&\"key\"!=n.type[0]||(\"key\"==n.type[0]&&(o.code+=e.compile.ml(\"hash_key\")),o.code+=e.compile.ml(\"implicit_account\")),o.code+=e.compile.ml(\"address\"),o}}},function(e,t){e.exports=function(e){return function(t){var o={code:\"\",type:[\"contract\"]};if(1!=t.length)throw\"Invalid arguments for function\";var n=e.compile.code(t.shift()),i=[\"unit\"];if(o.code+=n.code,\"address\"==n.type[0])t.length&&(i=e.parse.type(t.shift()[0])),o.code+=\"CONTRACT \"+e.compile.type(i)+\";\",o.code+=e.compile.error(\"Invalid contract param\");else{if(\"key_hash\"!=n.type[0]&&\"key\"!=n.type[0])throw\"Unsupported type for argument to_contract\";\"key\"==n.type[0]&&(o.code+=e.compile.ml(\"hash_key\")),o.code+=e.compile.ml(\"implicit_account\")}return o.type.push(i),o}}},function(e,t){e.exports=function(e){return function(t){var o={code:\"\",type:[\"int\"]};if(1!=t.length)throw\"Invalid arguments for function\";var n=e.compile.code(t.shift());if([\"mutez\",\"nat\",\"int\"].indexOf(n.type[0])<0)throw\"Argument for to_int must be mutez, nat or int\";return\"int\"==n.type[0]||(o.code+=n.code,\"mutez\"==n.type[0]&&(o.code+=e.compile.ml(\"dip\",\"PUSH mutez 1;\"),o.code+=\"EDIV;\"+compile.error(\"Error with casting\")+\"CAR;\"),o.code+=\"PUSH int 1;MUL;\"),o}}},function(e,t){e.exports=function(e){return function(t){var o={code:\"\",type:[\"nat\"]};if(1!=t.length)throw\"Invalid arguments for function\";var n=e.compile.code(t.shift());if([\"mutez\",\"nat\",\"int\"].indexOf(n.type[0])<0)throw\"Invalid argument types\";return\"nat\"==n.type[0]||(o.code+=n.code,\"mutez\"==n.type[0]?(o.code+=e.compile.ml(\"dip\",\"PUSH mutez 1;\"),o.code+=\"EDIV;\"+compile.error(\"Error with casting\")+\"CAR;\"):o.code+='DUP;GT;IF{}{Push string \"Nat conversion not possible\";FAILWITH};ABS;'),o}}},function(e,t){e.exports=function(e){return function(t){var o={code:\"\",type:[\"option\"]};if(1!=t.length)throw\"Invalid arguments for function\";var n=e.compile.code(t.shift());return o.code+=n.code,o.code+=e.compile.ml(\"some\"),o.type.push(n.type),o}}},function(e,t){e.exports=function(e){return function(t){var o={code:\"\",type:[\"key_hash\"]};if(1!=t.length)throw\"Invalid arguments for function\";if(\"key\"!=e.compile.code(t.shift()).type[0])throw\"Invalid type\";return o.code+=c.code,o.code+=\"HASH_KEY;\",o}}},function(e,t){e.exports=function(e){return function(t){var o={code:\"\",type:\"\"};if(1!=t.length)throw\"Invalid arguments for function\";var n=e.compile.code(t.shift());if(\"option\"!=n.type[0])throw\"Invalid type\";return o.code+=n.code,o.code+='IF_SOME{}{PUSH string \"Optional value is empty\";FAILWITH};',o.type=n.type[1],o}}},function(e,t){e.exports=function(e){return function(t){var o={code:\"\",type:!1},n=e.compile.code(t.shift()),i=e.compile.code(t.shift()),r=[\"unit\"];if([\"contract\",\"address\",\"key\",\"key_hash\"].indexOf(n.type[0])<0)throw\"Invalid type\";if(\"mutez\"!=i.type[0])throw\"Invalid type\";if(t.length){var c=e.compile.code(t.shift());o.code+=c.code,r=c.type}else o.code+=\"UNIT;\";return o.code+=e.compile.ml(\"dip\",i.code),\"key_hash\"==n.type[0]||\"key\"==n.type[0]?(\"key\"==n.type[0]&&(n.code+=e.compile.ml(\"hash_key\")),n.code+=e.compile.ml(\"implicit_account\")):\"address\"==n.type[0]&&(n.code+=\"CONTRACT \"+e.compile.type(r)+\";\"+e.compile.error(\"Invalid contract\")),o.code+=e.compile.ml(\"diip\",n.code),o.code+=\"TRANSFER_TOKENS;\",o.code+=e.compile.operation(),o}}},function(e,t){e.exports=function(e){return function(t){var o={code:\"\",type:!1},n=e.compile.code(t.shift()),i=e.compile.rawType(t.shift()[0]);return o.code+=n.code,o.code+=\"UNPACK \"+i+\";\",o.code+=e.compile.error(\"Unable to unpack\"),o.type=i,o}}},function(e,t){e.exports=function(e){return function(t){var o={code:\"\",type:[\"bool\"]};if(3!=t.length)throw\"Invalid arguments for verify function\";var n=e.compile.code(t.shift()),i=e.compile.code(t.shift()),r=e.compile.code(t.shift());if(\"key\"!=r.type[0])throw\"Invalid type, expecting key\";if(\"bytes\"!=n.type[0])throw\"Invalid type, expecting bytes\";if(\"bytes\"!=i.type[0])throw\"Invalid type, expecting bytes\";return o.code+=r.code,o.code+=e.compile.ml(\"dip\",i.code),o.code+=e.compile.ml(\"diip\",n.code),o.code+=\"CHECK_SIGNATURE;\",o}}},function(e,t,o){var n={map:{},literalTypes:[\"string\",\"bool\",\"int\",\"nat\",\"bytes\",\"mutez\",\"timestamp\",\"address\",\"key\",\"key_hash\",\"signature\",\"operation\",\"unit\"],complexTypes:[\"set\",\"map\",\"big_map\",\"contract\",\"list\",\"option\"]};n.helper=o(37),n.parse=o(38)(n),n.compile=o(43)(n),e.exports={compile:n.compile.script,version:\"0.0.1b\",core:n}},function(e,t){e.exports={findInObjArray:function(e,t,o){for(var n=0;n<e.length;n+=1)if(e[n][t]===o)return n;return-1}}},function(e,t,o){e.exports=function(e){return{main:o(39)(e),condition:o(40)(e),type:o(41)(e),typeList:o(42)(e)}}},function(e,t){e.exports=function(e){var t=function(o){for(var n=!1,i=[],r=[],c=\"\",p=\"\",a=!1,s=!1,l=0,d=0,f=0,u=!1,m=0;m<o.length;m++)if(c=o[m],s)\"\\n\"==c&&(s=!1);else{if(a){if(n)n=!1;else if(\"\\\\\"==c)n=!0;else if('\"'==c){r.push(p),a=!1,p=\"\";continue}}else{if(\"\"==p&&/\\s/.test(c))continue;if(0<f){if(\"]\"==c&&f--,\"[\"==c&&f++,0==f){var h=r.pop();h+=\"[\"+p.trim()+\"]\",r.push(h),p=\"\";continue}}else if(0<l){if(\")\"==c&&l--,\"(\"==c&&l++,0==l||1==l&&\",\"==c){if(0<=[\"if\",\"assert\"].indexOf(r[0])){if(\",\"==c)throw\"Error in condition\";r.push(e.parse.condition(p.trim()))}else\"\"!=p.trim()&&r.push(t(p.trim()));p=\"\";continue}}else if(0<d){if(\"}\"==c&&d--,\"{\"==c&&d++,0==d){r.push(t(p.trim())),i.push(r),r=[],p=\"\";continue}}else{if(\"#\"==c){\"\"!=p.trim()&&r.push(p.trim()),s=!(p=\"\");continue}if('\"'==c){a=!0,\"\"!=p.trim()&&r.push(p.trim()),p=\"\";continue}if(\"[\"==c){f=1,\"\"!=p.trim()&&r.push(p.trim()),p=\"\";continue}if(\"{\"==c){d=1,\"\"!=p.trim()&&(\"else\"==p.trim()?r=i.pop():r.push(p.trim())),p=\"\";continue}if(\"(\"==c){if(l=1,\"\"!=p.trim())if(0<p.indexOf(\".\")){var y=p.split(\".\");r.unshift(y.pop()),r.unshift(\"ext\"),p=y.join(\".\"),r.push(p.trim())}else r.push(p.trim());p=\"\";continue}if(\"=\"==c){\"\"!=p.trim()&&r.push(p.trim()),\"let\"!=r[0]&&r.unshift(\"set\"),i.push(r),r=[],u=!0,p=\"\";continue}if(\",\"==c){r.push(p.trim()),p=\"\";continue}if(\" \"==c){\"else\"==p?r=i.pop():r.push(p.trim()),p=\"\";continue}if(\";\"==c){\"\"!=p&&r.push(p.trim()),u?((h=i.pop()).push(r),i.push(h),u=!1):i.push(r),r=[],p=\"\";continue}}}p+=c}if(a)throw\"Syntax error, string not closed\";if(0<f)throw\"Unclosed square bracket\";if(0<l)throw\"Unclosed parenthesis\";if(0<d)throw\"Unclosed curly bracket\";return p.trim()&&r.push(p.trim()),r.length&&i.push(r),1==i.length&&(i=i[0]),i};return t}},function(e,t){e.exports=function(e){return parseCondition=function(t){t=(t=(t=(t=(t=(t=(t=(t=t.replace(/!=/g,\"neq\")).replace(/<=/g,\"le\")).replace(/>=/g,\"ge\")).replace(/</g,\"lt\")).replace(/>/g,\"gt\")).replace(/==/g,\"eq\")).replace(/&&/g,\"and\")).replace(/\\|\\|/g,\"or\");for(var o=\"\",n=\"\",i=\"\",r=[],c=[],p=0,a=[],s=0;s<t.length;s++)if(n=t[s],\"\"!=i||\" \"!=n)if(\"!\"!=n)if(0<p){if(\")\"==n&&p--,\"(\"==n&&p++,0==p){o?(a=e.parse.main(o+\"(\"+i+\")\"),o=\"\"):a=parseCondition(i),i=\"\";continue}i+=n}else{if(\"(\"==n){i&&(o=i),i=\"\",p++;continue}if(\" \"==n){0<=[\"and\",\"or\"].indexOf(i)?(a.length&&r.length&&r.push(a),a.length&&!r.length&&(r=a),c=c.length?(c.push(r),[i,c]):[i,r],r=[],a=[]):0<=[\"neq\",\"le\",\"ge\",\"lt\",\"gt\",\"eq\"].indexOf(i)?(r=[i,a],a=[]):a.push(i),i=\"\";continue}i+=n}else r.unshift(\"neq\");return\"\"!=i&&a.push(i),a.length&&(r.length?r.push(a):c.push(a)),r.length&&c.push(r),1==c.length&&(c=c[0]),[\"neq\",\"le\",\"ge\",\"lt\",\"gt\",\"eq\",\"and\",\"or\"].indexOf(c[0])<0&&(c=[\"eq\",c]),c}}},function(e,t){e.exports=function(e){return parseType=function(e){for(var t=[],o=\"\",n=\"\",i=0,r=0;r<e.length;r++)if(n=e[r],\"\"!=o||\" \"!=n)if(0<i){if(\"]\"==n&&i--,\"[\"==n&&i++,1==i&&\",\"==n){t.push(o),o=\"\";continue}if(1==i&&\"=\"==n&&\">\"==e[r+1]){t.push(o),o=\"\",r++;continue}if(0==i){if(\"\"==o&&1==t.length){t.unshift(\"list\");continue}t.push(o),o=\"\";continue}o+=n}else{if(\"?\"==n){t.push(\"option\"),o=\"\";continue}if(\"[\"==n){i++,t.push(o),o=\"\";continue}if(\" \"==n){t.push(o),o=\"\";continue}o+=n}\"\"!=o&&t.push(o),console.log(\"tt\",t);var c=t.shift(),p=\"\";switch(c){case\"tz1\":case\"pkh\":p=[\"key_hash\"];break;case\"string\":case\"int\":case\"nat\":case\"bool\":case\"timestamp\":case\"mutez\":case\"address\":case\"operation\":case\"key\":case\"key_hash\":case\"signature\":case\"bytes\":p=[c];break;case\"map\":p=[\"map\",parseType(t[0]),parseType(t[1])];break;case\"bmap\":p=[\"big_map\",parseType(t[0]),parseType(t[1])];break;case\"contract\":p=[\"contract\",parseType(t[0])];break;case\"list\":p=[\"list\",parseType(t[0])];break;case\"option\":p=[\"option\",parseType(t[0])];break;case\"set\":p=[\"set\",parseType(t[0])];break;default:p=[c]}return p}}},function(e,t){e.exports=function(e){return function(t){for(var o=[],n=0;n<t.length;n++)t[n].length<=0||o.push({name:t[n][1],type:e.parse.type(t[n][0])});return o}}},function(e,t,o){e.exports=function(e){var t=function(o,n){var i=(o=o.splice(0)).shift(),c=e.helper.findInObjArray(n,\"name\",i);if(c<0)throw\"Error with variable \"+i;var p=n.length;if(0<o.length){nt=n[c].type;var a=t(o,e.map.struct[e.helper.findInObjArray(e.map.struct,\"name\",nt[0])].type);return r={ind:a.push([c,p]),type:a.type},r}return r={ind:[[c,p]],type:n[c].type},r},n=function(o){var n,i,r,c,p,a,s=o;if(o=o.split(\".\"),n=\"storage\"==(i=0<=[\"storage\",\"input\"].indexOf(o[0])?o.shift():\"temp\")?e.map.storage:e.map.entry[e.currentCall][i],0<o.length){try{var l=t(o,n),d=l.ind.reverse();r=l.type}catch(o){throw\"Unknown variable \"+s}for(var f=\"C\",u=\"\",m=0;m<d.length;m++)u+=(c=d[m][0],p=d[m][1],a=void 0,a=\"\",0==c&&1==p||(a+=\"D\".repeat(c),c<p-1&&(a+=\"A\")),a)}else f=\"C\",u=\"\",r=[i];if(\"temp\"==i)return f+=\"A\",f+=u,{code:f+=\"R;\",type:r};if(0<e.map.entry[e.currentCall].temp.length&&(f+=\"D\"),\"input\"==i)return f+=\"A\",f+=u,{code:f+=\"R;\",type:r};if(0<e.map.entry[e.currentCall].input.length&&(f+=\"D\"),\"storage\"==i)return f+=\"D\",f+=u,{code:f+=\"R;\",type:r};throw\"error\"};return{script:o(44)(e),code:o(45)(e),condition:o(47)(e),type:o(48)(e),rawType:function(t){return e.compile.type(e.parse.type(t))},namedType:o(49)(e),operation:function(){var t=\"C\";return 0<e.map.entry[e.currentCall].temp.length&&(t+=\"D\"),0<e.map.entry[e.currentCall].input.length&&(t+=\"D\"),\"DIP{DUP;\"+(t+=\"AR;\")+\"};CONS;SWAP;SET_\"+t},ml:function(e,t){var o=e.toUpperCase();return void 0!==t&&(o+=\"{\"+t+\"}\"),o+\";\"},literal:function(e,t){if(0<=[\"bytes\",\"bool\"].indexOf(e))return t;if(0<=[\"nat\",\"int\",\"mutez\"].indexOf(e)){if(isNaN(t))throw\"NaN error: \"+t;return parseInt(t)}return'\"'+t+'\"'},error:function(e){return\"IF_SOME{}{PUSH \"+(e=\"string\"==typeof e?'string \"'+e+'\"':\"nat \"+parseInt(e))+\";FAILWITH};\"},getter:function(e){var t=n(e);return{code:\"DUP;\"+t.code,type:t.type}},setter:function(e){var t=n(e);return{code:\"SWAP;SET_\"+t.code,type:t.type}}}}},function(e,t){e.exports=function(e){return function(t){var o,n,i=[\"const\",\"struct\",\"storage\",\"entry\",\"function\"],r=\"string\"==typeof t?e.parse.main(t):t;e.map={},e.currentCall=\"\";for(var c=0;c<r.length;c++){if(n=(o=r[c].slice(0)).shift(),i.indexOf(n)<0)throw\"Unexpected definition at root level: \"+n;switch(void 0===e.map[n]&&(e.map[n]=[]),n){case\"const\":var p={};p.type=o.shift(),p.name=o.shift(),p.value=o.shift(),e.map[n].push(p);break;case\"struct\":var a=o.shift();e.map[n].push({name:a,type:e.parse.typeList(o)});break;case\"storage\":var s=o.shift();a=o.shift(),e.map[n].push({name:a,type:e.parse.type(s)});break;case\"entry\":for(var l=o.shift(),d=o.pop(),f=[];o.length;)f.push(o.shift());for(var u=[],m=[],h=0;h<d.length;h++){if(\"let\"==d[h][0]){d[h].shift();var y=d[h].shift(),g=d[h][0];if(u.push({name:g,type:e.parse.type(y)}),!(1<d[h].length))continue;d[h].unshift(\"set\")}m.push(d[h])}e.map[n].push({name:l,input:e.parse.typeList(f),temp:u,code:m});break;case\"function\":throw\"Function is not currently supported\"}}if(void 0===e.map.entry)throw\"No defined entry calls\";if(e.map.entry.length<=0)throw\"No defined entry calls\";var v,I=[];for(v=void 0!==e.map.storage?e.compile.namedType(e.map.storage):\"unit\",c=0;c<e.map.entry.length;c++){e.currentCall=c;var w=\"\";if(0==e.map.entry[e.currentCall].input.length?w+=e.compile.ml(\"drop\"):(w+=\"UNPACK \"+e.compile.namedType(e.map.entry[e.currentCall].input)+\";\",w+=e.compile.error(100),w+=\"PAIR;\"),0!=e.map.entry[e.currentCall].temp.length){var x=[];for(c=0;c<e.map.entry[e.currentCall].temp.length;c++)x.unshift(e.compile.namedType([e.map.entry[e.currentCall].temp[c]]));if(w+=\"NONE \"+x[0]+\";\",1<x.length)for(c=1;c<x.length;c++)w+=\"NONE \"+x[c]+\";PAIR;\";w+=\"PAIR;\"}w+=e.compile.code(e.map.entry[e.currentCall].code);var b=\"\";e.map.entry[e.currentCall].input.length&&(b+=\"D\"),e.map.entry[e.currentCall].temp.length&&(b+=\"D\"),b&&(w+=\"C\"+b+\"R;\"),I.push(w)}var O=\"\";if(O+=\"parameter bytes;\",O+=\"storage \"+v+\";\",O+=\"code{DUP;CDR;NIL operation;PAIR;SWAP;CAR;\",1==I.length)O+=I[0];else{O+=\"UNPACK (pair nat bytes);\"+e.compile.error(100)+\"UNPAIR;\";var _=\"\";for(c=0;c<I.length;c++)O+=\"DUP;PUSH nat \"+c+\";IFCMPEQ{DROP;\"+I[c]+\"}{\",_+=\"}\";O+=\"DROP;PUSH nat 400;FAILWITH;\"+_}return O+\"};\"}}},function(e,t,o){e.exports=function(e){for(var t=[\"add\",\"sub\",\"mul\",\"div\"],n=[\"in\",\"length\",\"get\",\"push\",\"drop\",\"pop\"],i={},r={BALANCE:{code:\"BALANCE;\",type:\"mutez\"},SOURCE:{code:\"SOURCE;\",type:\"address\"},SENDER:{code:\"SENDER;\",type:\"address\"},SELF:{code:\"SELF;\",type:\"contract *\"},ME:{code:\"SELF;ADDRESS;\",type:\"address\"},AMOUNT:{code:\"AMOUNT;\",type:\"mutez\"},STEPS:{code:\"STEPS_TO_QUOTA;\",type:\"nat\"},STEPS_TO_QUOTA:{code:\"STEPS_TO_QUOTA;\",type:\"nat\"},NOW:{code:\"NOW;\",type:\"timestamp\"}},c=[\"abs\",\"add\",\"assert\",\"concat\",\"concat_ws\",\"delegate\",\"div\",\"drop\",\"get\",\"hash\",\"if\",\"in\",\"isset\",\"length\",\"mod\",\"mul\",\"neg\",\"new\",\"pack\",\"pop\",\"push\",\"set\",\"slice\",\"sqr\",\"sub\",\"throw\",\"to_address\",\"to_contract\",\"to_int\",\"to_nat\",\"to_optional\",\"to_pkh\",\"to_some\",\"transfer\",\"unpack\",\"verify\"],p=0;p<c.length;p++)i[c[p]]=o(46)(\"./\"+c[p])(e);var a=function(o){var c=(o=o.slice(0)).shift();if(\"ext\"==c)if(c=o.shift(),0<=n.indexOf(c)){var p=o.shift();o.unshift([p])}else{if(!(0<=t.indexOf(c)))throw\"Unknown variable modifier/function\";o=[p=o.shift(),[c,[p],o.slice(0)]],c=\"set\"}else\"to_pkh\"==c?c=\"hash_key\":\"to_implicit\"==c&&(c=\"implicit_account\");if(0<=e.literalTypes.indexOf(c))return{code:\"PUSH \"+c+\" \"+e.compile.literal(c,o.shift())+\";\",type:[c]};if(void 0!==r[c])return{code:r[c].code,type:[r[c].type]};if(void 0!==e.map.const&&0<=e.helper.findInObjArray(e.map.const,\"name\",c)){var a=e.helper.findInObjArray(e.map.const,\"name\",c);return{code:\"PUSH \"+e.map.const[a].type+\" \"+e.compile.literal(e.map.const[a].type,e.map.const[a].value)+\";\",type:e.map.const[a].type}}return void 0!==i[c]?i[c](o):e.compile.getter(c)};return function(t){if(\"string\"==typeof t&&(t=e.parse.main(t)),\"string\"==typeof t[0])return a(t);for(var o=\"\",n=0;n<t.length;n++)if(op=t[n].slice(0),op.length){try{var i=a(op)}catch(t){throw op+t}if(\"string\"!=typeof i.code)throw\"Invalid line function\";if(i.type)throw\"Invalid line function\";o+=i.code}return o}}},function(e,t,o){var n={\"./abs\":0,\"./abs.js\":0,\"./add\":1,\"./add.js\":1,\"./assert\":2,\"./assert.js\":2,\"./concat\":3,\"./concat.js\":3,\"./concat_ws\":4,\"./concat_ws.js\":4,\"./delegate\":5,\"./delegate.js\":5,\"./div\":6,\"./div.js\":6,\"./drop\":7,\"./drop.js\":7,\"./get\":8,\"./get.js\":8,\"./hash\":9,\"./hash.js\":9,\"./if\":10,\"./if.js\":10,\"./in\":11,\"./in.js\":11,\"./isset\":12,\"./isset.js\":12,\"./length\":13,\"./length.js\":13,\"./mod\":14,\"./mod.js\":14,\"./mul\":15,\"./mul.js\":15,\"./neg\":16,\"./neg.js\":16,\"./new\":17,\"./new.js\":17,\"./pack\":18,\"./pack.js\":18,\"./pop\":19,\"./pop.js\":19,\"./push\":20,\"./push.js\":20,\"./set\":21,\"./set.js\":21,\"./slice\":22,\"./slice.js\":22,\"./sqr\":23,\"./sqr.js\":23,\"./sub\":24,\"./sub.js\":24,\"./throw\":25,\"./throw.js\":25,\"./to_address\":26,\"./to_address.js\":26,\"./to_contract\":27,\"./to_contract.js\":27,\"./to_int\":28,\"./to_int.js\":28,\"./to_nat\":29,\"./to_nat.js\":29,\"./to_optional\":30,\"./to_optional.js\":30,\"./to_pkh\":31,\"./to_pkh.js\":31,\"./to_some\":32,\"./to_some.js\":32,\"./transfer\":33,\"./transfer.js\":33,\"./unpack\":34,\"./unpack.js\":34,\"./verify\":35,\"./verify.js\":35};function i(e){var t=r(e);return o(t)}function r(e){if(o.o(n,e))return n[e];var t=new Error(\"Cannot find module '\"+e+\"'\");throw t.code=\"MODULE_NOT_FOUND\",t}i.keys=function(){return Object.keys(n)},i.resolve=r,(e.exports=i).id=46},function(e,t){e.exports=function(e){return compileCondition=function(t){if(t.length<2||3<t.length)throw\"Error with condition\";var o=t[0],n=t[1];n=0<=[\"and\",\"or\",\"neq\",\"le\",\"ge\",\"lt\",\"gt\",\"eq\"].indexOf(n[0])?compileCondition(n):e.compile.code(n).code,2==t.length?rhs=[\"bool\",\"True\"]:rhs=t[2],0<=[\"and\",\"or\",\"neq\",\"le\",\"ge\",\"lt\",\"gt\",\"eq\"].indexOf(rhs[0])?rhs=compileCondition(rhs):rhs=e.compile.code(rhs).code;var i=n+\"DIP{\"+rhs+\"};\";return 0<=[\"and\",\"or\"].indexOf(o)?i+=o.toUpperCase()+\";\":0<=[\"neq\",\"le\",\"ge\",\"lt\",\"gt\",\"eq\"].indexOf(o)&&(i+=\"COMPARE;\"+o.toUpperCase()+\";\"),i}}},function(e,t){e.exports=function(e){return compileType=function(t){if(\"string\"==typeof(t=t.slice(0))&&(t=[[t]]),\"string\"==typeof t[0]&&(t=[t]),0==t.length)return\"unit\";if(1!=t.length){var o=\"(pair \";o+=compileType([t.shift()]),o+=\" \";for(var n=\"\";1<t.length;)o+=\"(pair \",o+=compileType([t.shift()]),o+=\" \",n+=\")\";return o+=compileType([t.shift()]),(o+=\")\")+n}if(0<=e.literalTypes.indexOf(t[0][0]))return t[0][0];if(\"unit\"==t[0][0])return t[0][0];if(!(0<=e.complexTypes.indexOf(t[0][0])))return console.log(t),e.compile.namedType(e.map.struct[e.helper.findInObjArray(e.map.struct,\"name\",t[0][0])].type);switch(t[0][0]){case\"map\":return\"(map \"+compileType([t[0][1]])+\" \"+compileType([t[0][2]])+\")\";case\"big_map\":return\"(big_map \"+compileType([t[0][1]])+\" \"+compileType([t[0][2]])+\")\";case\"contract\":return\"(contract \"+compileType([t[0][1]])+\")\";case\"list\":return\"(list \"+compileType([t[0][1]])+\")\";case\"set\":return\"(set \"+compileType([t[0][1]])+\")\";case\"option\":return\"(option \"+compileType([t[0][1]])+\")\"}}}},function(e,t){e.exports=function(e){return function(t){if(0==(t=t.slice(0)).length)return\"unit\";for(var o=[];t.length;){var n=t.shift();o.push(n.type)}return e.compile.type(o)}}}]);","extractedComments":[]}